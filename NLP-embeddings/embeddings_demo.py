import streamlit as st
import numpy as np
import plotly.graph_objects as go
from sklearn.manifold import TSNE
import pandas as pd

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(page_title="–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏", layout="wide")

# –ó–∞–≥–æ–ª–æ–≤–æ–∫
st.title("üî§ –î–µ–º–æ: –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤")
st.markdown("""
–≠—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≥–æ, –∫–∞–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–æ–≤.
–ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤–µ–∫—Ç–æ—Ä–æ–º —á–∏—Å–µ–ª, –∏ –ø–æ—Ö–æ–∂–∏–µ –ø–æ —Å–º—ã—Å–ª—É —Å–ª–æ–≤–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.
""")

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è —Ä—É—Å—Å–∫–∏—Ö —Å–ª–æ–≤ (—Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è –¥–µ–º–æ)
# –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ç–∏–ø–∞ Word2Vec –∏–ª–∏ FastText
@st.cache_data
def load_embeddings():
    """–ó–∞–≥—Ä—É–∂–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏"""
    words = {
        # –ñ–∏–≤–æ—Ç–Ω—ã–µ –¥–æ–º–∞—à–Ω–∏–µ
        '–∫–æ—Ç': np.array([0.9, 0.8, 0.1, 0.2, 0.1, 0.15, 0.2]),
        '—Å–æ–±–∞–∫–∞': np.array([0.85, 0.75, 0.15, 0.25, 0.12, 0.18, 0.22]),
        '—Ö–æ–º—è–∫': np.array([0.88, 0.78, 0.12, 0.22, 0.13, 0.16, 0.21]),
        '–ø–æ–ø—É–≥–∞–π': np.array([0.82, 0.76, 0.18, 0.28, 0.14, 0.19, 0.23]),
        
        # –ñ–∏–≤–æ—Ç–Ω—ã–µ –¥–∏–∫–∏–µ
        '—Ç–∏–≥—Ä': np.array([0.88, 0.7, 0.3, 0.2, 0.15, 0.4, 0.35]),
        '–ª–µ–≤': np.array([0.87, 0.72, 0.32, 0.18, 0.14, 0.42, 0.33]),
        '–º–µ–¥–≤–µ–¥—å': np.array([0.86, 0.68, 0.34, 0.22, 0.16, 0.38, 0.36]),
        '–≤–æ–ª–∫': np.array([0.84, 0.71, 0.31, 0.21, 0.17, 0.39, 0.34]),
        '—Å–ª–æ–Ω': np.array([0.83, 0.69, 0.33, 0.19, 0.18, 0.41, 0.32]),
        
        # –ü—Ç–∏—Ü—ã
        '–≤–æ—Ä–æ–±–µ–π': np.array([0.75, 0.85, 0.2, 0.15, 0.1, 0.25, 0.3]),
        '–æ—Ä–µ–ª': np.array([0.78, 0.82, 0.25, 0.18, 0.12, 0.45, 0.38]),
        '–≥–æ–ª—É–±—å': np.array([0.76, 0.84, 0.22, 0.16, 0.11, 0.23, 0.28]),
        
        # –§—Ä—É–∫—Ç—ã
        '—è–±–ª–æ–∫–æ': np.array([0.1, 0.2, 0.9, 0.8, 0.1, 0.15, 0.12]),
        '–≥—Ä—É—à–∞': np.array([0.15, 0.22, 0.88, 0.82, 0.12, 0.17, 0.14]),
        '–±–∞–Ω–∞–Ω': np.array([0.12, 0.25, 0.85, 0.78, 0.15, 0.16, 0.13]),
        '–∞–ø–µ–ª—å—Å–∏–Ω': np.array([0.13, 0.23, 0.87, 0.81, 0.13, 0.14, 0.15]),
        '–≤–∏–Ω–æ–≥—Ä–∞–¥': np.array([0.14, 0.24, 0.86, 0.79, 0.14, 0.18, 0.16]),
        
        # –û–≤–æ—â–∏
        '–ø–æ–º–∏–¥–æ—Ä': np.array([0.16, 0.26, 0.84, 0.77, 0.16, 0.2, 0.18]),
        '–æ–≥—É—Ä–µ—Ü': np.array([0.17, 0.27, 0.83, 0.76, 0.17, 0.21, 0.19]),
        '–º–æ—Ä–∫–æ–≤—å': np.array([0.18, 0.28, 0.82, 0.75, 0.18, 0.22, 0.2]),
        
        # –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –Ω–∞–∑–µ–º–Ω—ã–π
        '–º–∞—à–∏–Ω–∞': np.array([0.2, 0.1, 0.1, 0.2, 0.9, 0.15, 0.2]),
        '–∞–≤—Ç–æ–±—É—Å': np.array([0.22, 0.12, 0.12, 0.22, 0.88, 0.17, 0.22]),
        '–≤–µ–ª–æ—Å–∏–ø–µ–¥': np.array([0.25, 0.15, 0.15, 0.25, 0.85, 0.19, 0.24]),
        '–º–æ—Ç–æ—Ü–∏–∫–ª': np.array([0.23, 0.13, 0.13, 0.23, 0.87, 0.18, 0.23]),
        '–≥—Ä—É–∑–æ–≤–∏–∫': np.array([0.21, 0.11, 0.11, 0.21, 0.89, 0.16, 0.21]),
        
        # –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –≤–æ–∑–¥—É—à–Ω—ã–π/–≤–æ–¥–Ω—ã–π
        '—Å–∞–º–æ–ª–µ—Ç': np.array([0.3, 0.2, 0.15, 0.25, 0.8, 0.85, 0.7]),
        '–∫–æ—Ä–∞–±–ª—å': np.array([0.32, 0.22, 0.17, 0.27, 0.78, 0.15, 0.85]),
        '–≤–µ—Ä—Ç–æ–ª–µ—Ç': np.array([0.31, 0.21, 0.16, 0.26, 0.79, 0.83, 0.68]),
        
        # –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ/–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ
        '–≤—Ä–∞—á': np.array([0.5, 0.3, 0.6, 0.7, 0.2, 0.4, 0.35]),
        '–º–µ–¥—Å–µ—Å—Ç—Ä–∞': np.array([0.52, 0.32, 0.62, 0.72, 0.22, 0.42, 0.37]),
        '—É—á–∏—Ç–µ–ª—å': np.array([0.48, 0.35, 0.58, 0.75, 0.24, 0.45, 0.4]),
        '–ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä': np.array([0.49, 0.36, 0.59, 0.76, 0.25, 0.46, 0.41]),
        '—Å—Ç—É–¥–µ–Ω—Ç': np.array([0.47, 0.37, 0.57, 0.74, 0.26, 0.44, 0.39]),
        
        # –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ
        '–∏–Ω–∂–µ–Ω–µ—Ä': np.array([0.3, 0.2, 0.2, 0.3, 0.8, 0.5, 0.45]),
        '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç': np.array([0.32, 0.22, 0.22, 0.32, 0.82, 0.52, 0.47]),
        '–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä': np.array([0.31, 0.21, 0.21, 0.31, 0.81, 0.51, 0.46]),
        
        # –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ
        '—Ö—É–¥–æ–∂–Ω–∏–∫': np.array([0.7, 0.8, 0.5, 0.4, 0.3, 0.6, 0.55]),
        '–º—É–∑—ã–∫–∞–Ω—Ç': np.array([0.72, 0.82, 0.52, 0.42, 0.32, 0.62, 0.57]),
        '–ø–∏—Å–∞—Ç–µ–ª—å': np.array([0.71, 0.81, 0.51, 0.41, 0.31, 0.61, 0.56]),
        
        # –≠–º–æ—Ü–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
        '—Ä–∞–¥–æ—Å—Ç—å': np.array([0.8, 0.9, 0.3, 0.2, 0.1, 0.25, 0.15]),
        '—Å—á–∞—Å—Ç—å–µ': np.array([0.82, 0.88, 0.32, 0.18, 0.12, 0.27, 0.17]),
        '–≤–æ—Å—Ç–æ—Ä–≥': np.array([0.85, 0.92, 0.35, 0.22, 0.13, 0.28, 0.18]),
        '–ª—é–±–æ–≤—å': np.array([0.83, 0.89, 0.33, 0.19, 0.14, 0.26, 0.16]),
        
        # –≠–º–æ—Ü–∏–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ
        '–≥—Ä—É—Å—Ç—å': np.array([0.2, 0.1, 0.3, 0.8, 0.9, 0.7, 0.75]),
        '–ø–µ—á–∞–ª—å': np.array([0.22, 0.12, 0.32, 0.82, 0.88, 0.72, 0.77]),
        '—Ç–æ—Å–∫–∞': np.array([0.21, 0.11, 0.31, 0.81, 0.89, 0.71, 0.76]),
        '—Å—Ç—Ä–∞—Ö': np.array([0.25, 0.15, 0.35, 0.85, 0.92, 0.75, 0.8]),
        '–≥–Ω–µ–≤': np.array([0.28, 0.18, 0.38, 0.88, 0.85, 0.78, 0.82]),
        
        # –ü—Ä–∏—Ä–æ–¥–∞ - —Ä–∞—Å—Ç–µ–Ω–∏—è
        '–¥–µ—Ä–µ–≤–æ': np.array([0.4, 0.5, 0.7, 0.6, 0.3, 0.35, 0.4]),
        '—Ü–≤–µ—Ç–æ–∫': np.array([0.42, 0.52, 0.72, 0.58, 0.28, 0.37, 0.42]),
        '—Ç—Ä–∞–≤–∞': np.array([0.41, 0.51, 0.71, 0.59, 0.29, 0.36, 0.41]),
        '–∫—É—Å—Ç': np.array([0.43, 0.53, 0.73, 0.57, 0.27, 0.38, 0.43]),
        
        # –ü—Ä–∏—Ä–æ–¥–∞ - –≤–æ–¥–æ–µ–º—ã
        '—Ä–µ–∫–∞': np.array([0.3, 0.6, 0.5, 0.4, 0.2, 0.8, 0.75]),
        '–æ–∑–µ—Ä–æ': np.array([0.32, 0.62, 0.52, 0.42, 0.22, 0.82, 0.77]),
        '–º–æ—Ä–µ': np.array([0.31, 0.61, 0.51, 0.41, 0.21, 0.81, 0.76]),
        '–æ–∫–µ–∞–Ω': np.array([0.33, 0.63, 0.53, 0.43, 0.23, 0.83, 0.78]),
        
        # –ü—Ä–∏—Ä–æ–¥–∞ - –ø–æ–≥–æ–¥–∞
        '—Å–æ–ª–Ω—Ü–µ': np.array([0.75, 0.85, 0.4, 0.3, 0.2, 0.5, 0.45]),
        '–¥–æ–∂–¥—å': np.array([0.35, 0.45, 0.55, 0.65, 0.5, 0.7, 0.65]),
        '—Å–Ω–µ–≥': np.array([0.38, 0.48, 0.58, 0.68, 0.52, 0.72, 0.67]),
        '–≤–µ—Ç–µ—Ä': np.array([0.36, 0.46, 0.56, 0.66, 0.51, 0.71, 0.66]),
        
        # –ï–¥–∞ - –±–ª—é–¥–∞
        '—Å—É–ø': np.array([0.2, 0.3, 0.75, 0.7, 0.25, 0.3, 0.35]),
        '–∫–∞—à–∞': np.array([0.22, 0.32, 0.77, 0.72, 0.27, 0.32, 0.37]),
        '—Å–∞–ª–∞—Ç': np.array([0.21, 0.31, 0.76, 0.71, 0.26, 0.31, 0.36]),
        
        # –ï–¥–∞ - —Å–ª–∞–¥–æ—Å—Ç–∏
        '—Ç–æ—Ä—Ç': np.array([0.6, 0.7, 0.8, 0.65, 0.2, 0.25, 0.3]),
        '–∫–æ–Ω—Ñ–µ—Ç–∞': np.array([0.62, 0.72, 0.82, 0.67, 0.22, 0.27, 0.32]),
        '—à–æ–∫–æ–ª–∞–¥': np.array([0.61, 0.71, 0.81, 0.66, 0.21, 0.26, 0.31]),
        
        # –ü—Ä–µ–¥–º–µ—Ç—ã –±—ã—Ç–∞
        '—Å—Ç–æ–ª': np.array([0.4, 0.3, 0.4, 0.5, 0.6, 0.4, 0.35]),
        '—Å—Ç—É–ª': np.array([0.42, 0.32, 0.42, 0.52, 0.62, 0.42, 0.37]),
        '–∫—Ä–æ–≤–∞—Ç—å': np.array([0.43, 0.33, 0.43, 0.53, 0.63, 0.43, 0.38]),
        '–¥–∏–≤–∞–Ω': np.array([0.44, 0.34, 0.44, 0.54, 0.64, 0.44, 0.39]),
        
        # –ß–∞—Å—Ç–∏ —Ç–µ–ª–∞
        '—Ä—É–∫–∞': np.array([0.55, 0.45, 0.35, 0.6, 0.4, 0.5, 0.55]),
        '–Ω–æ–≥–∞': np.array([0.56, 0.46, 0.36, 0.61, 0.41, 0.51, 0.56]),
        '–≥–æ–ª–æ–≤–∞': np.array([0.57, 0.47, 0.37, 0.62, 0.42, 0.52, 0.57]),
        '–≥–ª–∞–∑': np.array([0.58, 0.48, 0.38, 0.63, 0.43, 0.53, 0.58]),
        
        # –¶–≤–µ—Ç–∞
        '–∫—Ä–∞—Å–Ω—ã–π': np.array([0.9, 0.3, 0.2, 0.4, 0.3, 0.35, 0.4]),
        '—Å–∏–Ω–∏–π': np.array([0.3, 0.5, 0.9, 0.4, 0.3, 0.75, 0.8]),
        '–∑–µ–ª–µ–Ω—ã–π': np.array([0.4, 0.9, 0.5, 0.5, 0.3, 0.55, 0.5]),
        '–∂–µ–ª—Ç—ã–π': np.array([0.85, 0.8, 0.3, 0.35, 0.25, 0.4, 0.35]),
        '—á–µ—Ä–Ω—ã–π': np.array([0.1, 0.1, 0.1, 0.9, 0.85, 0.8, 0.85]),
        '–±–µ–ª—ã–π': np.array([0.95, 0.95, 0.95, 0.2, 0.15, 0.25, 0.2]),
        
        # –í—Ä–µ–º—è —Å—É—Ç–æ–∫
        '—É—Ç—Ä–æ': np.array([0.7, 0.8, 0.5, 0.3, 0.2, 0.4, 0.35]),
        '–¥–µ–Ω—å': np.array([0.8, 0.85, 0.45, 0.25, 0.18, 0.38, 0.33]),
        '–≤–µ—á–µ—Ä': np.array([0.5, 0.6, 0.55, 0.5, 0.4, 0.5, 0.55]),
        '–Ω–æ—á—å': np.array([0.2, 0.25, 0.3, 0.8, 0.75, 0.7, 0.75]),
        
        # –ó–¥–∞–Ω–∏—è
        '–¥–æ–º': np.array([0.45, 0.4, 0.45, 0.55, 0.65, 0.5, 0.45]),
        '—à–∫–æ–ª–∞': np.array([0.46, 0.42, 0.56, 0.73, 0.28, 0.48, 0.43]),
        '–±–æ–ª—å–Ω–∏—Ü–∞': np.array([0.51, 0.31, 0.61, 0.71, 0.23, 0.41, 0.36]),
        '–º–∞–≥–∞–∑–∏–Ω': np.array([0.47, 0.41, 0.78, 0.68, 0.35, 0.49, 0.44]),
    }
    
    return words

def cosine_similarity(v1, v2):
    """–í—ã—á–∏—Å–ª—è–µ–º –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É –¥–≤—É–º—è –≤–µ–∫—Ç–æ—Ä–∞–º–∏"""
    return np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))

# –ó–∞–≥—Ä—É–∂–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
embeddings = load_embeddings()
word_list = list(embeddings.keys())

# –°–æ–∑–¥–∞–µ–º –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏
col1, col2 = st.columns([1, 1])

with col1:
    st.header("üìä –ò–∑–º–µ—Ä–µ–Ω–∏–µ –±–ª–∏–∑–æ—Å—Ç–∏ —Å–ª–æ–≤")
    
    word1 = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ:", word_list, index=0)
    word2 = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ç–æ—Ä–æ–µ —Å–ª–æ–≤–æ:", word_list, index=1)
    
    if word1 and word2:
        vec1 = embeddings[word1]
        vec2 = embeddings[word2]
        
        cos_sim = cosine_similarity(vec1, vec2)
        
        st.markdown("---")
        st.subheader(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è: **{word1}** –∏ **{word2}**")
        
        # –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
        st.metric("–ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ", f"{cos_sim:.3f}")
        st.progress(float((cos_sim + 1) / 2))  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –æ—Ç -1..1 –¥–æ 0..1
        
        st.markdown("""
        **–ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≥–æ–ª –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏:
        - 1.0 = –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –ø–æ —Å–º—ã—Å–ª—É
        - 0.0 = –Ω–µ —Å–≤—è–∑–∞–Ω—ã
        - -1.0 = –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ
        """)

with col2:
    st.header("üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è")
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
    words_to_plot = st.multiselect(
        "–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–≤–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:",
        word_list,
        default=word_list[:10]  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–≤—ã–µ 10
    )
    
    if len(words_to_plot) >= 2:
        # –°–æ–∑–¥–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
        matrix = np.array([embeddings[w] for w in words_to_plot])
        
        # –°–Ω–∏–∂–∞–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–æ 2D —Å –ø–æ–º–æ—â—å—é t-SNE
        reducer = TSNE(n_components=2, random_state=42, perplexity=min(5, len(words_to_plot)-1))
        coords_2d = reducer.fit_transform(matrix)
        
        # –°–æ–∑–¥–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
        fig = go.Figure()
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏
        fig.add_trace(go.Scatter(
            x=coords_2d[:, 0],
            y=coords_2d[:, 1],
            mode='markers+text',
            text=words_to_plot,
            textposition='top center',
            marker=dict(
                size=15,
                color=list(range(len(words_to_plot))),
                colorscale='Viridis',
                showscale=False,
                line=dict(width=2, color='white')
            ),
            textfont=dict(size=12, color='black')
        ))
        
        # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –¥–≤–∞ —Å–ª–æ–≤–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é –º–µ–∂–¥—É –Ω–∏–º–∏
        if word1 in words_to_plot and word2 in words_to_plot:
            idx1 = words_to_plot.index(word1)
            idx2 = words_to_plot.index(word2)
            
            fig.add_trace(go.Scatter(
                x=[coords_2d[idx1, 0], coords_2d[idx2, 0]],
                y=[coords_2d[idx1, 1], coords_2d[idx2, 1]],
                mode='lines',
                line=dict(color='red', width=2, dash='dash'),
                showlegend=False
            ))
        
        fig.update_layout(
            title="–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–ª–æ–≤",
            xaxis_title="–ò–∑–º–µ—Ä–µ–Ω–∏–µ 1",
            yaxis_title="–ò–∑–º–µ—Ä–µ–Ω–∏–µ 2",
            height=500,
            showlegend=False,
            hovermode='closest'
        )
        
        st.plotly_chart(fig, use_container_width=True)
        
        st.info("""
        üí° **–ö–∞–∫ —á–∏—Ç–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫:**
        - –°–ª–æ–≤–∞ —Å –ø–æ—Ö–æ–∂–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É
        - –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –±–ª–∏–∑–æ—Å—Ç—å
        - –ö—Ä–∞—Å–Ω–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
        """)

# –†–∞–∑–¥–µ–ª —Å –ø–æ–∏—Å–∫–æ–º –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤
st.markdown("---")
st.header("üîç –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤")

search_word = st.selectbox("–ù–∞–π—Ç–∏ —Å–ª–æ–≤–∞, –ø–æ—Ö–æ–∂–∏–µ –Ω–∞:", word_list, index=0, key="search")

if search_word:
    search_vec = embeddings[search_word]
    
    # –í—ã—á–∏—Å–ª—è–µ–º —Å—Ö–æ–¥—Å—Ç–≤–æ —Å–æ –≤—Å–µ–º–∏ —Å–ª–æ–≤–∞–º–∏
    similarities = []
    for word, vec in embeddings.items():
        if word != search_word:
            sim = cosine_similarity(search_vec, vec)
            similarities.append((word, sim))
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ö–æ–¥—Å—Ç–≤–∞
    similarities.sort(key=lambda x: x[1], reverse=True)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-5
    st.subheader(f"–°–∞–º—ã–µ –ø–æ—Ö–æ–∂–∏–µ —Å–ª–æ–≤–∞ –Ω–∞ **{search_word}**:")
    
    for i, (word, sim) in enumerate(similarities[:5], 1):
        col_a, col_b, col_c = st.columns([1, 3, 1])
        with col_a:
            st.write(f"**{i}.**")
        with col_b:
            st.write(f"**{word}**")
        with col_c:
            st.write(f"{sim:.3f}")
        st.progress(float((sim + 1) / 2))

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
st.markdown("---")
with st.expander("‚ÑπÔ∏è –ß—Ç–æ —Ç–∞–∫–æ–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏?"):
    st.markdown("""
    ### –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
    
    **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏** - —ç—Ç–æ —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤ –≤ –≤–∏–¥–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ —á–∏—Å–µ–ª. 
    
    **–ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏:**
    1. –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —Ç–æ—á–∫–æ–π –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ (–æ–±—ã—á–Ω–æ 100-300 –∏–∑–º–µ—Ä–µ–Ω–∏–π)
    2. –°–ª–æ–≤–∞ —Å –ø–æ—Ö–æ–∂–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É
    3. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ª–æ–≤–∞–º–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º–∏!
    
    **–ü—Ä–∏–º–µ—Ä:**
    - –≤–µ–∫—Ç–æ—Ä("–∫–æ—Ä–æ–ª—å") - –≤–µ–∫—Ç–æ—Ä("–º—É–∂—á–∏–Ω–∞") + –≤–µ–∫—Ç–æ—Ä("–∂–µ–Ω—â–∏–Ω–∞") ‚âà –≤–µ–∫—Ç–æ—Ä("–∫–æ—Ä–æ–ª–µ–≤–∞")
    
    **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
    - –ü–æ–∏—Å–∫–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã
    - –ú–∞—à–∏–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥
    - –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞
    - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
    - ChatGPT –∏ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
    
    **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è. –†–µ–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –æ–±—É—á–∞—é—Ç—Å—è 
    –Ω–∞ –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö —Å–ª–æ–≤ –∏ –∏–º–µ—é—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π.
    """)

st.markdown("---")
st.caption("–î–µ–º–æ –¥–ª—è —Å–µ–º–∏–Ω–∞—Ä–∞ –ø–æ NLP | 2026")
